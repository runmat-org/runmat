{
  "suite": {
    "version": 1,
    "started_at": "2025-11-21T23:29:52.117462Z",
    "finished_at": "2025-11-21T23:43:13.352247Z",
    "auto_offload_calibration": {
      "runs": 18,
      "cpu_time_ms": {
        "elementwise": 1875.4200370230187,
        "reduction": 0.0,
        "matmul": 0.0
      },
      "units": {
        "elementwise": 56.0,
        "reduction": 0.0,
        "matmul_flops": 0.0
      },
      "provider": {
        "backend": "metal",
        "device_id": 1,
        "memory_bytes": 20100448256,
        "name": "Apple M2 Max",
        "vendor": "Apple"
      }
    }
  },
  "cases": [
    {
      "id": "4k-image-processing",
      "label": "4K Image Pipeline Perf Sweep",
      "parity_ok": true,
      "parity": [],
      "sweep": {
        "param": "B",
        "values": [
          4,
          8,
          16,
          32,
          64
        ]
      },
      "results": [
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 142.97474999330007,
          "all_ms": [
            220.93270800542086,
            141.35650001117028,
            142.97474999330007
          ],
          "mse": 0.2850092,
          "stdout_tail": "RESULT_ok MSE=2.850092e-1\n",
          "stderr_tail": "ps=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:29:52.624278000Z  INFO runmat_accelerate::backend::wgpu::provider_impl] Compiling image_normalize pipeline tuning: batch_tile=4 values/thread=8 lane=256 spatial=4\n[runmat] Compiling image_normalize pipeline: batch_tile=4 values_per_thread=8 lane_count=256 spatial_tile=4\n[2025-11-21T23:29:52.697885000Z  INFO runmat] Script executed successfully in 92.867584ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767792612
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 2960805009.5308805,
                  "decision": "gpu",
                  "elements": 33177600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767792657
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 2960805009.5308805,
                  "decision": "gpu",
                  "elements": 33177600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767792668
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 2960805009.5308805,
                  "decision": "gpu",
                  "elements": 33177600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767792677
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0xb9d0f40f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 34632541
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 5583708
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 4,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 33177600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 4
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 500.34125000820495,
          "all_ms": [
            591.2894590001088,
            500.34125000820495,
            495.8727920020465
          ],
          "mse": 0.2850724,
          "stdout_tail": "RESULT_ok MSE=2.850724e-01\n",
          "stderr_tail": "",
          "B": 4
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 801.2906670046505,
          "all_ms": [
            1154.1868339991197,
            801.2906670046505,
            790.4074999969453
          ],
          "mse": 0.285215,
          "stdout_tail": "RESULT_ok MSE=2.852150e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 4
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 212.76741600013338,
          "all_ms": [
            290.7887499895878,
            210.00600000843406,
            212.76741600013338
          ],
          "mse": 14076030000.0,
          "stdout_tail": "RESULT_ok MSE=1.407603e10\n",
          "stderr_tail": "s=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:29:57.699703000Z  INFO runmat_accelerate::backend::wgpu::provider_impl] Compiling image_normalize pipeline tuning: batch_tile=8 values/thread=8 lane=256 spatial=4\n[runmat] Compiling image_normalize pipeline: batch_tile=8 values_per_thread=8 lane_count=256 spatial_tile=4\n[2025-11-21T23:29:57.830383000Z  INFO runmat] Script executed successfully in 158.916333ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767797679
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 5921610019.061761,
                  "decision": "gpu",
                  "elements": 66355200,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767797763
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 5921610019.061761,
                  "decision": "gpu",
                  "elements": 66355200,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767797778
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 5921610019.061761,
                  "decision": "gpu",
                  "elements": 66355200,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767797794
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0xa4ee740f0"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 52522126
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 6783917
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 4,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 66355200
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 8
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 939.2672920075711,
          "all_ms": [
            954.0332500182558,
            939.2672920075711,
            930.9787919919472
          ],
          "mse": 0.2850916,
          "stdout_tail": "RESULT_ok MSE=2.850916e-01\n",
          "stderr_tail": "",
          "B": 8
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 808.9177089859731,
          "all_ms": [
            808.9177089859731,
            802.5542499963194,
            809.0171250223648
          ],
          "mse": 0.2851851,
          "stdout_tail": "RESULT_ok MSE=2.851851e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 8
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 241.55712500214577,
          "all_ms": [
            331.51437499327585,
            241.55712500214577,
            235.01137498533353
          ],
          "mse": 0.3333283,
          "stdout_tail": "RESULT_ok MSE=3.333283e-1\n",
          "stderr_tail": "te::backend::wgpu::provider_impl] Compiling image_normalize pipeline tuning: batch_tile=16 values/thread=8 lane=256 spatial=4\n[runmat] Compiling image_normalize pipeline: batch_tile=16 values_per_thread=8 lane_count=256 spatial_tile=4\n[2025-11-21T23:30:03.832638000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-image-normalize-out: large GPU allocation (530841600 bytes) len=132710400 elems\n[2025-11-21T23:30:03.967380000Z  INFO runmat] Script executed successfully in 186.289166ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767803787
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 11843220038.123522,
                  "decision": "gpu",
                  "elements": 132710400,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767803849
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 11843220038.123522,
                  "decision": "gpu",
                  "elements": 132710400,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767803875
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 11843220038.123522,
                  "decision": "gpu",
                  "elements": 132710400,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767803903
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0x73f1710f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 91447876
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 9011333
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 4,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 132710400
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 16
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1783.4747500019148,
          "all_ms": [
            1783.4747500019148,
            1838.931375008542,
            1782.517125015147
          ],
          "mse": 0.2850792,
          "stdout_tail": "RESULT_ok MSE=2.850792e-01\n",
          "stderr_tail": "",
          "B": 16
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 907.7327919949312,
          "all_ms": [
            931.1099580081645,
            907.7327919949312,
            884.1869590105489
          ],
          "mse": 0.2851658,
          "stdout_tail": "RESULT_ok MSE=2.851658e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 16
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 389.24920800491236,
          "all_ms": [
            389.24920800491236,
            372.3362500022631,
            398.9099579921458
          ],
          "mse": 0.3333225,
          "stdout_tail": "RESULT_ok MSE=3.333225e-1\n",
          "stderr_tail": "e::backend::wgpu::provider_impl] Compiling image_normalize pipeline tuning: batch_tile=16 values/thread=8 lane=256 spatial=4\n[runmat] Compiling image_normalize pipeline: batch_tile=16 values_per_thread=8 lane_count=256 spatial_tile=4\n[2025-11-21T23:30:13.088212000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-image-normalize-out: large GPU allocation (1061683200 bytes) len=265420800 elems\n[2025-11-21T23:30:13.341437000Z  INFO runmat] Script executed successfully in 344.283959ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767813003
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 23686440076.247044,
                  "decision": "gpu",
                  "elements": 265420800,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767813125
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 23686440076.247044,
                  "decision": "gpu",
                  "elements": 265420800,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767813177
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 23686440076.247044,
                  "decision": "gpu",
                  "elements": 265420800,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767813230
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0xca45310f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 165363583
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 7992458
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 4,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 265420800
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 32
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 3605.9483339777216,
          "all_ms": [
            3630.163583002286,
            3575.59566598502,
            3605.9483339777216
          ],
          "mse": 0.2851013,
          "stdout_tail": "RESULT_ok MSE=2.851013e-01\n",
          "stderr_tail": "",
          "B": 32
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1141.9192909961566,
          "all_ms": [
            1111.7000829835888,
            1141.9192909961566,
            1164.693874976365
          ],
          "mse": 0.2850548,
          "stdout_tail": "RESULT_ok MSE=2.850548e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 32
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 683.5366250015795,
          "all_ms": [
            683.5366250015795,
            705.9259169909637,
            669.4199169869535
          ],
          "mse": 0.3333415,
          "stdout_tail": "RESULT_ok MSE=3.333415e-1\n",
          "stderr_tail": "e::backend::wgpu::provider_impl] Compiling image_normalize pipeline tuning: batch_tile=16 values/thread=8 lane=256 spatial=4\n[runmat] Compiling image_normalize pipeline: batch_tile=16 values_per_thread=8 lane_count=256 spatial_tile=4\n[2025-11-21T23:30:29.252739000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-image-normalize-out: large GPU allocation (2123366400 bytes) len=530841600 elems\n[2025-11-21T23:30:29.723418000Z  INFO runmat] Script executed successfully in 615.909375ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767829118
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 47372880152.49409,
                  "decision": "gpu",
                  "elements": 530841600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767829320
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 47372880152.49409,
                  "decision": "gpu",
                  "elements": 530841600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767829419
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 47372880152.49409,
                  "decision": "gpu",
                  "elements": 530841600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767829517
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0xa82cd00f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 308509668
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 10479458
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 4,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 530841600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 64
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 6958.275667013368,
          "all_ms": [
            6957.425708009396,
            7090.07979198941,
            6958.275667013368
          ],
          "mse": 0.2850831,
          "stdout_tail": "RESULT_ok MSE=2.850831e-01\n",
          "stderr_tail": "",
          "B": 64
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1203.1985420035198,
          "all_ms": [
            1203.1985420035198,
            1192.5242909928784,
            1233.2741249992978
          ],
          "mse": 0.2850757,
          "stdout_tail": "RESULT_ok MSE=2.850757e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 64
        }
      ],
      "summary": {
        "speedups": {
          "baseline": "python-numpy",
          "x_param": "B",
          "series": [
            {
              "impl": "python-torch",
              "points": [
                {
                  "param": 4,
                  "speedup": 0.6244191659919847
                },
                {
                  "param": 8,
                  "speedup": 1.161140721205126
                },
                {
                  "param": 16,
                  "speedup": 1.9647574327268258
                },
                {
                  "param": 32,
                  "speedup": 3.1577961440970683
                },
                {
                  "param": 64,
                  "speedup": 5.783148353410332
                }
              ],
              "mean_speedup": 2.5382523634862673,
              "auc_trapz": 200.1102529648316
            },
            {
              "impl": "runmat",
              "points": [
                {
                  "param": 4,
                  "speedup": 3.4995077804413115
                },
                {
                  "param": 8,
                  "speedup": 4.4145260099741135
                },
                {
                  "param": 16,
                  "speedup": 7.383242162639881
                },
                {
                  "param": 32,
                  "speedup": 9.263855288132568
                },
                {
                  "param": 64,
                  "speedup": 10.179813944859632
                }
              ],
              "mean_speedup": 6.9481890372095005,
              "auc_trapz": 507.2946276053416
            }
          ]
        },
        "telemetry": {
          "runs": 5,
          "per_point": [
            {
              "median_ms": 142.97474999330007,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 34.632541
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 5.583708
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 4
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 33177600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 4
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 212.76741600013338,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 52.522126
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 6.783917
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 4
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 66355200
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 8
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 241.55712500214577,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 91.447876
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 9.011333
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 4
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 132710400
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 16
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 389.24920800491236,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 165.363583
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 7.992458
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 4
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 265420800
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 32
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 683.5366250015795,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 308.509668
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 10.479458
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 4
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 530841600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 64
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            }
          ],
          "totals": {
            "upload_bytes": 100,
            "download_bytes": 20,
            "fused_elementwise": {
              "count": 20,
              "wall_ms": 652.475794
            },
            "fused_reduction": {
              "count": 5,
              "wall_ms": 39.850874
            },
            "matmul": {
              "count": 0,
              "wall_ms": 0.0
            },
            "fusion_cache": {
              "hits": 15,
              "misses": 20
            },
            "bind_group_cache": {
              "hits": 0,
              "misses": 20
            }
          },
          "device": {
            "backend": "metal",
            "device_id": 1,
            "memory_bytes": 20100448256,
            "name": "Apple M2 Max",
            "vendor": "Apple"
          },
          "auto_offload": {
            "base_source": "loaded-from-cache",
            "thresholds": {
              "binary_min_elems": 4096,
              "cpu_elem_per_elem": 0.08924108463333334,
              "cpu_matmul_per_flop": 2.5e-11,
              "cpu_reduction_per_elem": 1.2e-07,
              "matmul_min_flops": 262144,
              "reduction_min_elems": 4096,
              "small_batch_max_dim": 8,
              "small_batch_min_elems": 1048576,
              "unary_min_elems": 4096
            },
            "env_overrides_applied": false,
            "calibrate_duration_ms": null,
            "decision_counts_by_reason": {
              "threshold": 5,
              "residency": 15
            },
            "decision_counts_by_disposition": {
              "cpu": 5,
              "gpu": 15
            }
          },
          "auto_offload_calibration": {
            "runs": 5,
            "cpu_time_ms": {
              "elementwise": 977.7584560020712,
              "reduction": 0.0,
              "matmul": 0.0
            },
            "units": {
              "elementwise": 5.0,
              "reduction": 0.0,
              "matmul_flops": 0.0
            },
            "provider": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            }
          },
          "kernel_launch_totals": {
            "fused_elementwise": 5,
            "fused_reduction": 5
          }
        }
      }
    },
    {
      "id": "monte-carlo-analysis",
      "label": "Monte Carlo Perf Sweep",
      "parity_ok": true,
      "parity": [],
      "sweep": {
        "param": "M",
        "values": [
          250000,
          500000,
          1000000,
          2000000,
          5000000
        ]
      },
      "results": [
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 108.58429101062939,
          "all_ms": [
            108.58429101062939,
            105.44116600067355,
            110.38074997486547
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.5578746795654\n",
          "stderr_tail": "oad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:30:54.716637000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:30:54.770213000Z  INFO runmat] Script executed successfully in 54.26025ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854716
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854716
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854716
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854716
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854716
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854716
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854717
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854717
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854717
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 22310271.158333335,
                  "decision": "gpu",
                  "elements": 250000,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854748
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767854765
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 2,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "total_wall_time_ns": 43736751
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 4044000
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 7,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 250000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 250000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 1000004
            }
          },
          "M": 250000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 4065.8662079949863,
          "all_ms": [
            4041.7222500254866,
            4065.8662079949863,
            4213.61470798729
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.560496\n",
          "stderr_tail": "",
          "M": 250000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 824.4165000214707,
          "all_ms": [
            802.6304999948479,
            870.7690830051433,
            824.4165000214707
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.419365 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 250000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 136.10391700058244,
          "all_ms": [
            128.8127499865368,
            139.23000000067987,
            136.10391700058244
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.5261688232422\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:31:10.000018000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:31:10.081176000Z  INFO runmat] Script executed successfully in 81.840375ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870000
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870000
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870000
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870000
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870000
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870000
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870002
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870002
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870002
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 44620542.31666667,
                  "decision": "gpu",
                  "elements": 500000,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870058
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767870076
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 2,
                  "tag": "runmat-fusion-layout-2"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "total_wall_time_ns": 68727916
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 5375291
              },
              "fusion_cache_hits": 4,
              "fusion_cache_misses": 7,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 500000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 500000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 2000004
            }
          },
          "M": 500000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 8206.556124991039,
          "all_ms": [
            8206.556124991039,
            8310.282499995083,
            8033.775124989916
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.580228\n",
          "stderr_tail": "",
          "M": 500000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 900.1089170051273,
          "all_ms": [
            900.1089170051273,
            884.6229159971699,
            920.2103330171667
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.371815 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 500000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 188.0037909722887,
          "all_ms": [
            202.03633297933266,
            187.38295801449567,
            188.0037909722887
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.4868507385254\n",
          "stderr_tail": "d: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:31:37.879140000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:31:38.012111000Z  INFO runmat] Script executed successfully in 133.653333ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897879
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897879
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897879
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897879
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897879
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897879
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897883
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897883
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897883
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89241084.63333334,
                  "decision": "gpu",
                  "elements": 1000000,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767897987
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767898007
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 2,
                  "tag": "runmat-fusion-layout-2"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "total_wall_time_ns": 116841625
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 5652834
              },
              "fusion_cache_hits": 4,
              "fusion_cache_misses": 7,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1000000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 1000000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 4000004
            }
          },
          "M": 1000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 16092.49258399359,
          "all_ms": [
            16556.025458994554,
            16092.49258399359,
            15950.319833005778
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.468233\n",
          "stderr_tail": "",
          "M": 1000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 894.3198749911971,
          "all_ms": [
            930.9906660055276,
            894.3198749911971,
            886.166417010827
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.455097 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 1000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 297.64545799116604,
          "all_ms": [
            288.9007500198204,
            297.64545799116604,
            333.7670409819111
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.4807071685791\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:32:30.051166000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:32:30.330056000Z  INFO runmat] Script executed successfully in 279.56425ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950051
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950051
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950051
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950051
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950051
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950051
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950057
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950057
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950057
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 178482169.26666668,
                  "decision": "gpu",
                  "elements": 2000000,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950304
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763767950325
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 2,
                  "tag": "runmat-fusion-layout-2"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "total_wall_time_ns": 257736459
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 5505375
              },
              "fusion_cache_hits": 4,
              "fusion_cache_misses": 7,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 2000000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 2000000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 8000004
            }
          },
          "M": 2000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 32304.63729199255,
          "all_ms": [
            32116.08254100429,
            32304.63729199255,
            32758.437500015134
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.461781\n",
          "stderr_tail": "",
          "M": 2000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1108.8024999771733,
          "all_ms": [
            1108.8024999771733,
            1155.0167090026662,
            1087.8454160119873
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.462563 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 2000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 607.3575000045821,
          "all_ms": [
            595.896790997358,
            607.3575000045821,
            608.0693750118371
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.4518814086914\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:34:12.211259000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:34:12.763217000Z  INFO runmat] Script executed successfully in 552.60425ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052211
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052211
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052211
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052211
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052211
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052211
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052229
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052229
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "gpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "fusion-override",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052229
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205423.1666667,
                  "decision": "gpu",
                  "elements": 5000000,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052737
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768052758
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 2,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "total_wall_time_ns": 516643293
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 5463625
              },
              "fusion_cache_hits": 4,
              "fusion_cache_misses": 7,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 5000000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20000004
            }
          },
          "M": 5000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 79894.97812499758,
          "all_ms": [
            80395.33712502453,
            79894.97812499758,
            79399.75820799009
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.469337\n",
          "stderr_tail": "",
          "M": 5000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1697.5881250109524,
          "all_ms": [
            1671.7221250000875,
            1697.5881250109524,
            1710.7511249778327
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.488119 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 5000000
        }
      ],
      "summary": {
        "speedups": {
          "baseline": "python-numpy",
          "x_param": "M",
          "series": [
            {
              "impl": "python-torch",
              "points": [
                {
                  "param": 250000,
                  "speedup": 4.93181081151226
                },
                {
                  "param": 500000,
                  "speedup": 9.11729232979512
                },
                {
                  "param": 1000000,
                  "speedup": 17.994112659245094
                },
                {
                  "param": 2000000,
                  "speedup": 29.134708203361374
                },
                {
                  "param": 5000000,
                  "speedup": 47.06381774700628
                }
              ],
              "mean_speedup": 21.648348350184026,
              "auc_trapz": 146396188.4967782
            },
            {
              "impl": "runmat",
              "points": [
                {
                  "param": 250000,
                  "speedup": 37.44433168143057
                },
                {
                  "param": 500000,
                  "speedup": 60.29625234779922
                },
                {
                  "param": 1000000,
                  "speedup": 85.59663877397868
                },
                {
                  "param": 2000000,
                  "speedup": 108.53395012314057
                },
                {
                  "param": 5000000,
                  "speedup": 131.5452235699647
                }
              ],
              "mean_speedup": 84.68327929926275,
              "auc_trapz": 505874850.77231574
            }
          ]
        },
        "telemetry": {
          "runs": 5,
          "per_point": [
            {
              "median_ms": 108.58429101062939,
              "upload_bytes": 1000004,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "wall_ms": 43.736751
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 4.044
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 7
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 250000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 250000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "M": 250000
              },
              "auto_offload": {
                "decisions_total": 11,
                "by_reason": {
                  "threshold": 7,
                  "fusion-override": 3,
                  "residency": 1
                },
                "by_decision": {
                  "cpu": 7,
                  "gpu": 4
                }
              }
            },
            {
              "median_ms": 136.10391700058244,
              "upload_bytes": 2000004,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "wall_ms": 68.727916
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 5.375291
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 4,
                "misses": 7
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 500000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 500000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "M": 500000
              },
              "auto_offload": {
                "decisions_total": 11,
                "by_reason": {
                  "threshold": 7,
                  "fusion-override": 3,
                  "residency": 1
                },
                "by_decision": {
                  "cpu": 7,
                  "gpu": 4
                }
              }
            },
            {
              "median_ms": 188.0037909722887,
              "upload_bytes": 4000004,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "wall_ms": 116.841625
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 5.652834
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 4,
                "misses": 7
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1000000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 1000000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "M": 1000000
              },
              "auto_offload": {
                "decisions_total": 11,
                "by_reason": {
                  "threshold": 7,
                  "fusion-override": 3,
                  "residency": 1
                },
                "by_decision": {
                  "cpu": 7,
                  "gpu": 4
                }
              }
            },
            {
              "median_ms": 297.64545799116604,
              "upload_bytes": 8000004,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "wall_ms": 257.736459
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 5.505375
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 4,
                "misses": 7
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 2000000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 2000000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "M": 2000000
              },
              "auto_offload": {
                "decisions_total": 11,
                "by_reason": {
                  "threshold": 7,
                  "fusion-override": 3,
                  "residency": 1
                },
                "by_decision": {
                  "cpu": 7,
                  "gpu": 4
                }
              }
            },
            {
              "median_ms": 607.3575000045821,
              "upload_bytes": 20000004,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 7,
                "wall_ms": 516.643293
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 5.463625
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 4,
                "misses": 7
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000000
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 5000000
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "M": 5000000
              },
              "auto_offload": {
                "decisions_total": 11,
                "by_reason": {
                  "threshold": 7,
                  "fusion-override": 3,
                  "residency": 1
                },
                "by_decision": {
                  "cpu": 7,
                  "gpu": 4
                }
              }
            }
          ],
          "totals": {
            "upload_bytes": 35000020,
            "download_bytes": 20,
            "fused_elementwise": {
              "count": 35,
              "wall_ms": 1003.686044
            },
            "fused_reduction": {
              "count": 5,
              "wall_ms": 26.041125
            },
            "matmul": {
              "count": 0,
              "wall_ms": 0.0
            },
            "fusion_cache": {
              "hits": 19,
              "misses": 35
            },
            "bind_group_cache": {
              "hits": 0,
              "misses": 19
            }
          },
          "device": {
            "backend": "metal",
            "device_id": 1,
            "memory_bytes": 20100448256,
            "name": "Apple M2 Max",
            "vendor": "Apple"
          },
          "auto_offload": {
            "base_source": "loaded-from-cache",
            "thresholds": {
              "binary_min_elems": 4096,
              "cpu_elem_per_elem": 0.08924108463333334,
              "cpu_matmul_per_flop": 2.5e-11,
              "cpu_reduction_per_elem": 1.2e-07,
              "matmul_min_flops": 262144,
              "reduction_min_elems": 4096,
              "small_batch_max_dim": 8,
              "small_batch_min_elems": 1048576,
              "unary_min_elems": 4096
            },
            "env_overrides_applied": false,
            "calibrate_duration_ms": null,
            "decision_counts_by_reason": {
              "threshold": 35,
              "fusion-override": 15,
              "residency": 5
            },
            "decision_counts_by_disposition": {
              "cpu": 35,
              "gpu": 20
            }
          },
          "auto_offload_calibration": {
            "runs": 5,
            "cpu_time_ms": {
              "elementwise": 307.96778797924867,
              "reduction": 0.0,
              "matmul": 0.0
            },
            "units": {
              "elementwise": 35.0,
              "reduction": 0.0,
              "matmul_flops": 0.0
            },
            "provider": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            }
          },
          "kernel_launch_totals": {
            "fused_elementwise": 10,
            "fused_reduction": 5
          }
        }
      }
    },
    {
      "id": "elementwise-math",
      "label": "Elementwise Math Perf Sweep",
      "parity_ok": true,
      "parity": [],
      "sweep": {
        "param": "points",
        "values": [
          1000000,
          2000000,
          5000000,
          10000000,
          100000000,
          200000000,
          500000000,
          1000000000
        ]
      },
      "results": [
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 145.14904201496392,
          "all_ms": [
            123.08233400108293,
            145.14904201496392,
            148.8457919913344
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:38:17.978189000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:38:18.058339000Z  INFO runmat] Script executed successfully in 80.640583ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768297978
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768297984
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768297995
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768298017
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768298033
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768298034
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768298034
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768298039
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768298042
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 71420374
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 1000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 72.38699999288656,
          "all_ms": [
            79.24462499795482,
            72.38699999288656,
            69.21733400668018
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 1000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 856.4117920177523,
          "all_ms": [
            896.0461670067161,
            856.4117920177523,
            855.5737079877872
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 1000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 149.75458299159072,
          "all_ms": [
            135.14762499835342,
            149.75458299159072,
            156.0581249941606
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:38:21.345717000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:38:21.430867000Z  INFO runmat] Script executed successfully in 85.605834ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301345
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301352
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301362
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301382
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301405
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301408
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301408
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301413
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768301415
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 76273542
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 2000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 79.48933300212957,
          "all_ms": [
            87.25883299484849,
            79.40862499526702,
            79.48933300212957
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 2000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 901.0459579876624,
          "all_ms": [
            954.0227499965113,
            897.9529580101371,
            901.0459579876624
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 2000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 145.13591601280496,
          "all_ms": [
            134.54120798269287,
            145.13591601280496,
            149.16716699372046
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:38:24.882697000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:38:24.961888000Z  INFO runmat] Script executed successfully in 79.653291ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304882
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304889
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304899
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304920
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304936
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304939
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304939
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304944
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768304946
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 70350958
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 5000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 119.45108399959281,
          "all_ms": [
            119.45108399959281,
            130.84812500164844,
            115.1292499853298
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 5000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1111.164625006495,
          "all_ms": [
            1131.8377919960767,
            1111.164625006495,
            1075.7046249927953
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 5000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 143.39379098964855,
          "all_ms": [
            137.16370801557787,
            143.39379098964855,
            144.5267499948386
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:38:29.097026000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:38:29.173108000Z  INFO runmat] Script executed successfully in 76.542166ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309097
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309103
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309114
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309135
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309149
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309150
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309150
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309155
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768309157
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 67255709
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 10000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 154.379167011939,
          "all_ms": [
            161.52329102624208,
            153.59870801330544,
            154.379167011939
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 10000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1377.4251250142697,
          "all_ms": [
            1377.4251250142697,
            1395.6127499986906,
            1366.4984999923036
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 10000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 144.81316599994898,
          "all_ms": [
            133.75937499222346,
            144.81316599994898,
            148.39449999271892
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "load: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:38:34.225643000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:38:34.304236000Z  INFO runmat] Script executed successfully in 79.0935ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314225
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314232
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314243
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314263
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314278
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314279
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314279
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314287
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768314288
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 68676249
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 100000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1073.0936249892693,
          "all_ms": [
            1073.0936249892693,
            1062.0052909944206,
            1081.1777909984812
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 100000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 16404.21970799798,
          "all_ms": [
            16404.21970799798,
            16273.03412501351,
            16413.61395898275
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 100000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 156.93925000960007,
          "all_ms": [
            128.83562501519918,
            160.29166599037126,
            156.93925000960007
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:39:27.071302000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:39:27.156888000Z  INFO runmat] Script executed successfully in 86.151792ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367071
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367080
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367094
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367118
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367133
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367134
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367134
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367141
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768367142
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 74589874
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 200000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 2114.6579589985777,
          "all_ms": [
            2095.600000000559,
            2148.2137080165558,
            2114.6579589985777
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 200000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 16558.975416992325,
          "all_ms": [
            16646.391624992248,
            16558.975416992325,
            16539.94179100846
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 200000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 137.58370801224373,
          "all_ms": [
            137.58370801224373,
            134.87149999127723,
            162.2448329871986
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:40:23.766571000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:40:23.858240000Z  INFO runmat] Script executed successfully in 92.218083ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423766
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423774
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423789
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423815
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423831
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423833
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423833
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423841
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768423842
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 80644082
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 500000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 5026.9426250015385,
          "all_ms": [
            5662.025750003522,
            4967.151167016709,
            5026.9426250015385
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 500000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 17882.112166000297,
          "all_ms": [
            18481.959333992563,
            17733.551374985836,
            17882.112166000297
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 500000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 144.39554201089777,
          "all_ms": [
            145.49704099772498,
            136.41337500303052,
            144.39554201089777
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-21T23:41:34.133820000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-21T23:41:34.210595000Z  INFO runmat] Script executed successfully in 77.249459ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494133
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494140
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494150
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494171
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494188
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494190
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494190
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494196
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763768494197
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 68260417
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 10,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 1000000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 11931.927708006697,
          "all_ms": [
            12592.941125010839,
            11874.381959001767,
            11931.927708006697
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 1000000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 20841.4241670107,
          "all_ms": [
            21337.768500001403,
            20841.4241670107,
            20509.694917011075
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 1000000000
        }
      ],
      "plot": {
        "log_x": true,
        "log_x_min": 1000000
      },
      "summary": {
        "speedups": {
          "baseline": "python-numpy",
          "x_param": "points",
          "series": [
            {
              "impl": "python-torch",
              "points": [
                {
                  "param": 1000000,
                  "speedup": 0.08452359094955814
                },
                {
                  "param": 2000000,
                  "speedup": 0.08821895520141491
                },
                {
                  "param": 5000000,
                  "speedup": 0.10750079809181703
                },
                {
                  "param": 10000000,
                  "speedup": 0.1120780826546486
                },
                {
                  "param": 100000000,
                  "speedup": 0.0654157066956422
                },
                {
                  "param": 200000000,
                  "speedup": 0.127704637862351
                },
                {
                  "param": 500000000,
                  "speedup": 0.28111570816334486
                },
                {
                  "param": 1000000000,
                  "speedup": 0.5725101899175109
                }
              ],
              "mean_speedup": 0.17988345869203595,
              "auc_trapz": 293301662.27761257
            },
            {
              "impl": "runmat",
              "points": [
                {
                  "param": 1000000,
                  "speedup": 0.4987080795574519
                },
                {
                  "param": 2000000,
                  "speedup": 0.5307973313016616
                },
                {
                  "param": 5000000,
                  "speedup": 0.8230291114781951
                },
                {
                  "param": 10000000,
                  "speedup": 1.0766098444463572
                },
                {
                  "param": 100000000,
                  "speedup": 7.410193800953481
                },
                {
                  "param": 200000000,
                  "speedup": 13.474372783540273
                },
                {
                  "param": 500000000,
                  "speedup": 36.53733932330262
                },
                {
                  "param": 1000000000,
                  "speedup": 82.63362941707837
                }
              ],
              "mean_speedup": 17.8730849614573,
              "auc_trapz": 38727928084.14877
            }
          ]
        },
        "telemetry": {
          "runs": 8,
          "per_point": [
            {
              "median_ms": 145.14904201496392,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 71.420374
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 1000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 149.75458299159072,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 76.273542
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 2000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 145.13591601280496,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 70.350958
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 5000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 143.39379098964855,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 67.255709
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 10000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 144.81316599994898,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 68.676249
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 100000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 156.93925000960007,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 74.589874
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 200000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 137.58370801224373,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 80.644082
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 500000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 144.39554201089777,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 68.260417
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 10
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 1000000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            }
          ],
          "totals": {
            "upload_bytes": 96,
            "download_bytes": 0,
            "fused_elementwise": {
              "count": 80,
              "wall_ms": 577.4712049999999
            },
            "fused_reduction": {
              "count": 0,
              "wall_ms": 0.0
            },
            "matmul": {
              "count": 0,
              "wall_ms": 0.0
            },
            "fusion_cache": {
              "hits": 24,
              "misses": 80
            },
            "bind_group_cache": {
              "hits": 0,
              "misses": 24
            }
          },
          "device": {
            "backend": "metal",
            "device_id": 1,
            "memory_bytes": 20100448256,
            "name": "Apple M2 Max",
            "vendor": "Apple"
          },
          "auto_offload": {
            "base_source": "loaded-from-cache",
            "thresholds": {
              "binary_min_elems": 4096,
              "cpu_elem_per_elem": 0.08924108463333334,
              "cpu_matmul_per_flop": 2.5e-11,
              "cpu_reduction_per_elem": 1.2e-07,
              "matmul_min_flops": 262144,
              "reduction_min_elems": 4096,
              "small_batch_max_dim": 8,
              "small_batch_min_elems": 1048576,
              "unary_min_elems": 4096
            },
            "env_overrides_applied": false,
            "calibrate_duration_ms": null,
            "decision_counts_by_reason": {
              "threshold": 16,
              "residency": 56
            },
            "decision_counts_by_disposition": {
              "cpu": 16,
              "gpu": 56
            }
          },
          "auto_offload_calibration": {
            "runs": 8,
            "cpu_time_ms": {
              "elementwise": 589.6937930416988,
              "reduction": 0.0,
              "matmul": 0.0
            },
            "units": {
              "elementwise": 16.0,
              "reduction": 0.0,
              "matmul_flops": 0.0
            },
            "provider": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            }
          },
          "kernel_launch_totals": {
            "fused_elementwise": 24
          }
        }
      }
    }
  ]
}