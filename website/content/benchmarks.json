{
  "suite": {
    "version": 1,
    "started_at": "2025-11-19T21:34:54.365125Z",
    "finished_at": "2025-11-19T21:49:37.452934Z",
    "auto_offload_calibration": {
      "runs": 13,
      "cpu_time_ms": {
        "elementwise": 2998.5855399964894,
        "reduction": 0.0,
        "matmul": 0.0
      },
      "units": {
        "elementwise": 21.0,
        "reduction": 0.0,
        "matmul_flops": 0.0
      },
      "provider": {
        "backend": "metal",
        "device_id": 1,
        "memory_bytes": 20100448256,
        "name": "Apple M2 Max",
        "vendor": "Apple"
      }
    }
  },
  "cases": [
    {
      "id": "4k-image-processing",
      "label": "4K Image Pipeline Perf Sweep",
      "parity_ok": true,
      "parity": [],
      "sweep": {
        "param": "B",
        "values": [
          4,
          8,
          16,
          32,
          64
        ]
      },
      "results": [
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 1,
          "median_ms": 223.50808400005917,
          "all_ms": [
            223.50808400005917
          ],
          "mse": 0.2850092,
          "stdout_tail": "RESULT_ok MSE=2.850092e-1\n",
          "stderr_tail": "d: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:00:14.271624000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:00:14.384670000Z  INFO runmat] Script executed successfully in 120.647084ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763586014271
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 2960805009.5308805,
                  "decision": "gpu",
                  "elements": 33177600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586014346
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 2960805009.5308805,
                  "decision": "gpu",
                  "elements": 33177600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586014355
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 2960805009.5308805,
                  "decision": "gpu",
                  "elements": 33177600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586014363
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0x982d800f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 30970167
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 6850250
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 33177600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 4
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 1,
          "median_ms": 529.9917089996597,
          "all_ms": [
            529.9917089996597
          ],
          "mse": 0.2850724,
          "stdout_tail": "RESULT_ok MSE=2.850724e-01\n",
          "stderr_tail": "",
          "B": 4
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 1,
          "median_ms": 924.6655419997296,
          "all_ms": [
            924.6655419997296
          ],
          "mse": 0.285215,
          "stdout_tail": "RESULT_ok MSE=2.852150e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 4
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 1,
          "median_ms": 298.60562500016385,
          "all_ms": [
            298.60562500016385
          ],
          "mse": 14076030000.0,
          "stdout_tail": "RESULT_ok MSE=1.407603e10\n",
          "stderr_tail": "d: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:00:16.112116000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:00:16.281792000Z  INFO runmat] Script executed successfully in 176.121667ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763586016112
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 5921610019.061761,
                  "decision": "gpu",
                  "elements": 66355200,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586016218
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 5921610019.061761,
                  "decision": "gpu",
                  "elements": 66355200,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586016232
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 5921610019.061761,
                  "decision": "gpu",
                  "elements": 66355200,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586016249
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0x740ed50f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 50348334
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 6766291
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 66355200
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 8
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 1,
          "median_ms": 1025.0025420000384,
          "all_ms": [
            1025.0025420000384
          ],
          "mse": 0.2850916,
          "stdout_tail": "RESULT_ok MSE=2.850916e-01\n",
          "stderr_tail": "",
          "B": 8
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 1,
          "median_ms": 980.4692499997145,
          "all_ms": [
            980.4692499997145
          ],
          "mse": 0.2851851,
          "stdout_tail": "RESULT_ok MSE=2.851851e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 8
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 1,
          "median_ms": 304.54966700017394,
          "all_ms": [
            304.54966700017394
          ],
          "mse": 0.3333283,
          "stdout_tail": "RESULT_ok MSE=3.333283e-1\n",
          "stderr_tail": "model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:00:18.541089000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-rng-uniform-out: large GPU allocation (530841600 bytes) len=132710400 elems\n[2025-11-19T21:00:18.598728000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-image-normalize-out: large GPU allocation (530841600 bytes) len=132710400 elems\n[2025-11-19T21:00:18.735673000Z  INFO runmat] Script executed successfully in 202.578791ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763586018540
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 11843220038.123522,
                  "decision": "gpu",
                  "elements": 132710400,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586018615
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 11843220038.123522,
                  "decision": "gpu",
                  "elements": 132710400,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586018643
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 11843220038.123522,
                  "decision": "gpu",
                  "elements": 132710400,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586018671
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0x7d566d0f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 93316458
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 7995709
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 132710400
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 16
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 1,
          "median_ms": 1855.5507080000098,
          "all_ms": [
            1855.5507080000098
          ],
          "mse": 0.2850792,
          "stdout_tail": "RESULT_ok MSE=2.850792e-01\n",
          "stderr_tail": "",
          "B": 16
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 1,
          "median_ms": 961.5065000002687,
          "all_ms": [
            961.5065000002687
          ],
          "mse": 0.2851658,
          "stdout_tail": "RESULT_ok MSE=2.851658e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 16
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 1,
          "median_ms": 466.63329200009684,
          "all_ms": [
            466.63329200009684
          ],
          "mse": 0.3333225,
          "stdout_tail": "RESULT_ok MSE=3.333225e-1\n",
          "stderr_tail": "del: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:00:21.807028000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-rng-uniform-out: large GPU allocation (1061683200 bytes) len=265420800 elems\n[2025-11-19T21:00:21.892216000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-image-normalize-out: large GPU allocation (1061683200 bytes) len=265420800 elems\n[2025-11-19T21:00:22.161352000Z  INFO runmat] Script executed successfully in 362.571959ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763586021806
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 23686440076.247044,
                  "decision": "gpu",
                  "elements": 265420800,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586021928
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 23686440076.247044,
                  "decision": "gpu",
                  "elements": 265420800,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586021980
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 23686440076.247044,
                  "decision": "gpu",
                  "elements": 265420800,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586022037
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0x9f75800f0"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 179753793
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 10555875
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 265420800
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 32
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 1,
          "median_ms": 3700.884374999987,
          "all_ms": [
            3700.884374999987
          ],
          "mse": 0.2851013,
          "stdout_tail": "RESULT_ok MSE=2.851013e-01\n",
          "stderr_tail": "",
          "B": 32
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 1,
          "median_ms": 1119.6692500002428,
          "all_ms": [
            1119.6692500002428
          ],
          "mse": 0.2850548,
          "stdout_tail": "RESULT_ok MSE=2.850548e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 32
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 1,
          "median_ms": 884.2817090003336,
          "all_ms": [
            884.2817090003336
          ],
          "mse": 0.3333415,
          "stdout_tail": "RESULT_ok MSE=3.333415e-1\n",
          "stderr_tail": "del: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:00:27.246402000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-rng-uniform-out: large GPU allocation (2123366400 bytes) len=530841600 elems\n[2025-11-19T21:00:27.422375000Z  WARN runmat_accelerate::backend::wgpu::provider_impl] runmat-image-normalize-out: large GPU allocation (2123366400 bytes) len=530841600 elems\n[2025-11-19T21:00:28.020672000Z  INFO runmat] Script executed successfully in 780.891667ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763586027246
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 47372880152.49409,
                  "decision": "gpu",
                  "elements": 530841600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586027493
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 47372880152.49409,
                  "decision": "gpu",
                  "elements": 530841600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586027621
                },
                {
                  "batch": 3840,
                  "cpu_estimate_ms": 47372880152.49409,
                  "decision": "gpu",
                  "elements": 530841600,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763586027753
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p2-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "layout_ptr_0x99c8610f0"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-reduction-p1-bgl"
                },
                {
                  "hits": 0,
                  "misses": 1,
                  "tag": "runmat-fusion-layout-1"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 4,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "total_wall_time_ns": 420575958
              },
              "fused_reduction": {
                "count": 1,
                "total_wall_time_ns": 13056209
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 530841600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 20
            }
          },
          "B": 64
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 1,
          "median_ms": 7199.190833000102,
          "all_ms": [
            7199.190833000102
          ],
          "mse": 0.2850831,
          "stdout_tail": "RESULT_ok MSE=2.850831e-01\n",
          "stderr_tail": "",
          "B": 64
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 1,
          "median_ms": 1328.0434999996942,
          "all_ms": [
            1328.0434999996942
          ],
          "mse": 0.2850757,
          "stdout_tail": "RESULT_ok MSE=2.850757e-01 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "B": 64
        }
      ],
      "summary": {
        "speedups": {
          "baseline": "python-numpy",
          "x_param": "B",
          "series": [
            {
              "impl": "python-torch",
              "points": [
                {
                  "param": 4,
                  "speedup": 0.5731712548230923
                },
                {
                  "param": 8,
                  "speedup": 1.045420386208274
                },
                {
                  "param": 16,
                  "speedup": 1.9298368840974982
                },
                {
                  "param": 32,
                  "speedup": 3.3053371564854395
                },
                {
                  "param": 64,
                  "speedup": 5.420899867362598
                }
              ],
              "mean_speedup": 2.4549331097953804,
              "auc_trapz": 196.63939706951794
            },
            {
              "impl": "runmat",
              "points": [
                {
                  "param": 4,
                  "speedup": 2.3712417891762674
                },
                {
                  "param": 8,
                  "speedup": 3.4326297168697875
                },
                {
                  "param": 16,
                  "speedup": 6.0927687962270864
                },
                {
                  "param": 32,
                  "speedup": 7.931033722727222
                },
                {
                  "param": 64,
                  "speedup": 8.141286605530576
                }
              ],
              "mean_speedup": 5.593792126106188,
              "auc_trapz": 419.0568824682389
            }
          ]
        },
        "telemetry": {
          "runs": 5,
          "per_point": [
            {
              "median_ms": 223.50808400005917,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 30.970167
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 6.85025
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 33177600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 4
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 298.60562500016385,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 50.348334
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 6.766291
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 66355200
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 8
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 304.54966700017394,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 93.316458
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 7.995709
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 132710400
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 16
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 466.63329200009684,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 179.753793
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 10.555875
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 265420800
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 32
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            },
            {
              "median_ms": 884.2817090003336,
              "upload_bytes": 20,
              "download_bytes": 4,
              "fused_elementwise": {
                "count": 4,
                "wall_ms": 420.575958
              },
              "fused_reduction": {
                "count": 1,
                "wall_ms": 13.056209
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 4
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 1
                    },
                    {
                      "key": "inputs",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 0
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_reduction",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "reduce_len",
                      "value": 530841600
                    },
                    {
                      "key": "slices",
                      "value": 1
                    },
                    {
                      "key": "rank",
                      "value": 1
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 256
                    },
                    {
                      "key": "flavor",
                      "value": 1
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "B": 64
              },
              "auto_offload": {
                "decisions_total": 4,
                "by_reason": {
                  "threshold": 1,
                  "residency": 3
                },
                "by_decision": {
                  "cpu": 1,
                  "gpu": 3
                }
              }
            }
          ],
          "totals": {
            "upload_bytes": 100,
            "download_bytes": 20,
            "fused_elementwise": {
              "count": 20,
              "wall_ms": 774.96471
            },
            "fused_reduction": {
              "count": 5,
              "wall_ms": 45.224334000000006
            },
            "matmul": {
              "count": 0,
              "wall_ms": 0.0
            },
            "fusion_cache": {
              "hits": 15,
              "misses": 185
            },
            "bind_group_cache": {
              "hits": 0,
              "misses": 20
            }
          },
          "device": {
            "backend": "metal",
            "device_id": 1,
            "memory_bytes": 20100448256,
            "name": "Apple M2 Max",
            "vendor": "Apple"
          },
          "auto_offload": {
            "base_source": "loaded-from-cache",
            "thresholds": {
              "binary_min_elems": 4096,
              "cpu_elem_per_elem": 0.08924108463333334,
              "cpu_matmul_per_flop": 2.5e-11,
              "cpu_reduction_per_elem": 1.2e-07,
              "matmul_min_flops": 262144,
              "reduction_min_elems": 4096,
              "small_batch_max_dim": 8,
              "small_batch_min_elems": 1048576,
              "unary_min_elems": 4096
            },
            "env_overrides_applied": false,
            "calibrate_duration_ms": null,
            "decision_counts_by_reason": {
              "threshold": 5,
              "residency": 15
            },
            "decision_counts_by_disposition": {
              "cpu": 5,
              "gpu": 15
            }
          },
          "auto_offload_calibration": {
            "runs": 5,
            "cpu_time_ms": {
              "elementwise": 1357.3893330008275,
              "reduction": 0.0,
              "matmul": 0.0
            },
            "units": {
              "elementwise": 5.0,
              "reduction": 0.0,
              "matmul_flops": 0.0
            },
            "provider": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            }
          },
          "kernel_launch_totals": {
            "fused_elementwise": 5,
            "fused_reduction": 5
          }
        }
      }
    },
    {
      "id": "monte-carlo-analysis",
      "label": "Monte Carlo Perf Sweep",
      "parity_ok": true,
      "parity": [],
      "sweep": {
        "param": "M",
        "values": [
          250000,
          500000,
          1000000,
          2000000,
          5000000
        ]
      },
      "results": [
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 198.33766700048727,
          "all_ms": [
            198.33766700048727,
            213.22016699923552,
            193.4136669997315
          ],
          "mse": null,
          "stdout_tail": "",
          "stderr_tail": "aches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:36:14.890340000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:36:14.955773000Z ERROR runmat] Script execution failed: Execution failed: No matching overload for `fprintf` with 2 args: fprintf: missing format string\n",
          "provider_telemetry": {
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 0,
              "fusion_cache_misses": 37,
              "kernel_launches": [],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 0
            }
          },
          "M": 250000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 4750.367165999705,
          "all_ms": [
            4750.367165999705,
            4844.104750000042,
            4729.674291000265
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.560496\n",
          "stderr_tail": "",
          "M": 250000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1086.3932919992294,
          "all_ms": [
            1100.696541000616,
            1031.9443329999558,
            1086.3932919992294
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.419365 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 250000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 219.47916699991765,
          "all_ms": [
            219.47916699991765,
            235.71850000007544,
            204.36349999999948
          ],
          "mse": null,
          "stdout_tail": "",
          "stderr_tail": "aches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:36:33.365263000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:36:33.460767000Z ERROR runmat] Script execution failed: Execution failed: No matching overload for `fprintf` with 2 args: fprintf: missing format string\n",
          "provider_telemetry": {
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 0,
              "fusion_cache_misses": 37,
              "kernel_launches": [],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 0
            }
          },
          "M": 500000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 9335.225457999513,
          "all_ms": [
            9220.866249999744,
            9335.225457999513,
            9363.59241700029
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.580228\n",
          "stderr_tail": "",
          "M": 500000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1102.0318339997175,
          "all_ms": [
            1152.3067909993188,
            1102.0318339997175,
            1075.5983340004605
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.371815 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 500000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 250.5979590005154,
          "all_ms": [
            258.6879999998928,
            245.63750000015716,
            250.5979590005154
          ],
          "mse": null,
          "stdout_tail": "",
          "stderr_tail": "aches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:37:05.611237000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:37:05.746566000Z ERROR runmat] Script execution failed: Execution failed: No matching overload for `fprintf` with 2 args: fprintf: missing format string\n",
          "provider_telemetry": {
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 0,
              "fusion_cache_misses": 37,
              "kernel_launches": [],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 0
            }
          },
          "M": 1000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 18643.763666999803,
          "all_ms": [
            18459.18208400053,
            18732.357874999252,
            18643.763666999803
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.468233\n",
          "stderr_tail": "",
          "M": 1000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1154.567708000286,
          "all_ms": [
            1204.316166999888,
            1154.567708000286,
            1149.2851250004605
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.455097 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 1000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 359.81379199984076,
          "all_ms": [
            388.1505419994937,
            354.35012499965524,
            359.81379199984076
          ],
          "mse": null,
          "stdout_tail": "",
          "stderr_tail": "aches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:38:06.241995000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:38:06.490703000Z ERROR runmat] Script execution failed: Execution failed: No matching overload for `fprintf` with 2 args: fprintf: missing format string\n",
          "provider_telemetry": {
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 0,
              "fusion_cache_misses": 37,
              "kernel_launches": [],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 0
            }
          },
          "M": 2000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 34934.87037500017,
          "all_ms": [
            36088.563249999424,
            33025.92991700021,
            34934.87037500017
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.461781\n",
          "stderr_tail": "",
          "M": 2000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1304.8052499998448,
          "all_ms": [
            1351.1344590006047,
            1297.474291999606,
            1304.8052499998448
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.462563 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 2000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 664.5763749993421,
          "all_ms": [
            698.3353340001486,
            664.5763749993421,
            663.0044590001489
          ],
          "mse": null,
          "stdout_tail": "",
          "stderr_tail": "aches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:39:56.311513000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:39:56.860038000Z ERROR runmat] Script execution failed: Execution failed: No matching overload for `fprintf` with 2 args: fprintf: missing format string\n",
          "provider_telemetry": {
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 0,
              "fusion_cache_misses": 37,
              "kernel_launches": [],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 0
            }
          },
          "M": 5000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 91703.57933299965,
          "all_ms": [
            92507.68512499963,
            91703.57933299965,
            87237.17162499997
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.469337\n",
          "stderr_tail": "",
          "M": 5000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1686.775208000654,
          "all_ms": [
            1686.775208000654,
            1703.461791999871,
            1686.423707999893
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok PRICE=25.488119 device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "M": 5000000
        }
      ],
      "summary": {
        "speedups": {
          "baseline": "python-numpy",
          "x_param": "M",
          "series": [
            {
              "impl": "python-torch",
              "points": [
                {
                  "param": 250000,
                  "speedup": 4.3726035506514105
                },
                {
                  "param": 500000,
                  "speedup": 8.470921773755137
                },
                {
                  "param": 1000000,
                  "speedup": 16.14783051510322
                },
                {
                  "param": 2000000,
                  "speedup": 26.774011198226194
                },
                {
                  "param": 5000000,
                  "speedup": 54.36621246152682
                }
              ],
              "mean_speedup": 22.026315899852555,
              "auc_trapz": 150931385.08405963
            },
            {
              "impl": "runmat",
              "points": [
                {
                  "param": 250000,
                  "speedup": 23.95090775161752
                },
                {
                  "param": 500000,
                  "speedup": 42.53353785511231
                },
                {
                  "param": 1000000,
                  "speedup": 74.3971089842813
                },
                {
                  "param": 2000000,
                  "speedup": 97.091526650028
                },
                {
                  "param": 5000000,
                  "speedup": 137.988021817794
                }
              ],
              "mean_speedup": 75.19222061176663,
              "auc_trapz": 475906857.92957723
            }
          ]
        },
        "telemetry": {
          "runs": 5,
          "per_point": [
            {
              "median_ms": 198.33766700048727,
              "upload_bytes": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 0,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 0
              },
              "status": "ok",
              "param": {
                "M": 250000
              }
            },
            {
              "median_ms": 219.47916699991765,
              "upload_bytes": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 0,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 0
              },
              "status": "ok",
              "param": {
                "M": 500000
              }
            },
            {
              "median_ms": 250.5979590005154,
              "upload_bytes": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 0,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 0
              },
              "status": "ok",
              "param": {
                "M": 1000000
              }
            },
            {
              "median_ms": 359.81379199984076,
              "upload_bytes": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 0,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 0
              },
              "status": "ok",
              "param": {
                "M": 2000000
              }
            },
            {
              "median_ms": 664.5763749993421,
              "upload_bytes": 0,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 0,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 0
              },
              "status": "ok",
              "param": {
                "M": 5000000
              }
            }
          ],
          "totals": {
            "upload_bytes": 0,
            "download_bytes": 0,
            "fused_elementwise": {
              "count": 0,
              "wall_ms": 0.0
            },
            "fused_reduction": {
              "count": 0,
              "wall_ms": 0.0
            },
            "matmul": {
              "count": 0,
              "wall_ms": 0.0
            },
            "fusion_cache": {
              "hits": 0,
              "misses": 185
            },
            "bind_group_cache": {
              "hits": 0,
              "misses": 0
            }
          },
          "device": {
            "backend": "metal",
            "device_id": 1,
            "memory_bytes": 20100448256,
            "name": "Apple M2 Max",
            "vendor": "Apple"
          }
        }
      }
    },
    {
      "id": "elementwise-math",
      "label": "Elementwise Math Perf Sweep",
      "parity_ok": true,
      "parity": [],
      "sweep": {
        "param": "points",
        "values": [
          1000000,
          2000000,
          5000000,
          10000000,
          100000000,
          200000000,
          500000000,
          1000000000
        ]
      },
      "results": [
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 206.5752500002418,
          "all_ms": [
            180.8635419993152,
            206.5752500002418,
            206.62933299990982
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:44:34.159532000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:44:34.248176000Z  INFO runmat] Script executed successfully in 89.228333ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674159
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674167
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674176
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674205
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674220
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674223
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674223
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674231
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588674232
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 77403958
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 1000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 65.10754199916846,
          "all_ms": [
            81.30454199999804,
            65.10754199916846,
            62.869832999240316
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 1000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 818.9267500001733,
          "all_ms": [
            818.9267500001733,
            813.805124999817,
            821.031459000551
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 1000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 207.71199999944656,
          "all_ms": [
            186.0659170006329,
            207.71199999944656,
            212.7442910004902
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:44:37.560964000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:44:37.656501000Z  INFO runmat] Script executed successfully in 96.200875ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677561
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677570
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677580
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677613
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677628
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677631
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677631
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677639
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588677640
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 83016873
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 2000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 76.98037499994825,
          "all_ms": [
            93.83704100036994,
            76.98037499994825,
            76.83875000020635
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 2000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 877.3257499997271,
          "all_ms": [
            877.3257499997271,
            861.9696669993573,
            901.3641669998833
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 2000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 206.91554099994391,
          "all_ms": [
            196.4924579997387,
            208.54733299984218,
            206.91554099994391
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:44:41.205474000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:44:41.295575000Z  INFO runmat] Script executed successfully in 90.760958ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681205
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681213
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681222
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681252
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681268
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681270
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681270
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681278
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588681280
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 78754335
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 5000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 112.13591700015968,
          "all_ms": [
            130.42937499994878,
            112.13591700015968,
            107.89145900071162
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 5000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1245.376292000401,
          "all_ms": [
            1245.376292000401,
            1249.2792079992796,
            1176.8090409996148
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 5000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 208.9523750000808,
          "all_ms": [
            185.56716600051004,
            212.2364999995625,
            208.9523750000808
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:44:45.975136000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:44:46.068011000Z  INFO runmat] Script executed successfully in 93.437542ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588685975
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588685983
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588685992
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588686020
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588686036
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588686037
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588686037
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588686044
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588686045
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 82899708
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 10000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 167.43233399938617,
          "all_ms": [
            174.72858400014957,
            167.43233399938617,
            159.1946660000758
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 10000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1386.4783330000137,
          "all_ms": [
            1386.4783330000137,
            1399.6172920005847,
            1381.959375000406
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 10000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 209.04262499971082,
          "all_ms": [
            195.47366599999805,
            209.48212499934016,
            209.04262499971082
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:44:51.409194000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:44:51.499023000Z  INFO runmat] Script executed successfully in 90.573625ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691409
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691417
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691425
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691454
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691471
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691474
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691474
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691482
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588691483
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 78560041
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 100000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 1069.6407499999623,
          "all_ms": [
            1121.5869159996146,
            1069.6407499999623,
            1056.4429590003783
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 100000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 16694.22562499949,
          "all_ms": [
            16694.22562499949,
            16221.130208000432,
            16733.68904200015
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 100000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 203.28070799951092,
          "all_ms": [
            196.10424999973475,
            203.28070799951092,
            212.38454099966475
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:45:45.055535000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:45:45.150004000Z  INFO runmat] Script executed successfully in 95.123833ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745055
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745065
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745075
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745106
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745122
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745124
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745124
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745132
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588745134
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 81680625
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 200000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 2069.533124999907,
          "all_ms": [
            2100.33520900015,
            2069.533124999907,
            2049.1924999996627
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 200000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 16811.446415999853,
          "all_ms": [
            16811.446415999853,
            16813.071709000724,
            16730.283833999238
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 200000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 211.1624169992865,
          "all_ms": [
            191.39274999997724,
            211.91308399920672,
            211.1624169992865
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:46:42.387607000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:46:42.481806000Z  INFO runmat] Script executed successfully in 94.845291ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802387
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802395
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802406
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802438
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802454
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802456
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802456
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802464
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588802466
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 82907001
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 500000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 5029.805166999722,
          "all_ms": [
            5574.846290999631,
            5029.805166999722,
            5004.226250000102
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 500000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 18019.03008299996,
          "all_ms": [
            19206.747167000685,
            18019.03008299996,
            17804.299833000186
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 500000000
        },
        {
          "impl": "runmat",
          "lang": "matlab-syntax",
          "iterations": 3,
          "median_ms": 203.85600000008708,
          "all_ms": [
            198.45741700009967,
            203.85600000008708,
            210.79933300006815
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "ad: loaded cached calibration for 'Apple M2 Max' from /Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json\n[2025-11-19T21:47:53.861424000Z  INFO runmat_accelerate::native_auto] Native auto-offload thresholds: unary=4096 binary=4096 reduction=4096 matmul_flops=262144 small_batch_dim=8 small_batch_min_elems=1048576 (model: fallback, source: loaded-from-cache, env_overrides=false)\n[2025-11-19T21:47:53.951784000Z  INFO runmat] Script executed successfully in 91.042334ms\n",
          "provider_telemetry": {
            "auto_offload": {
              "base_source": "loaded-from-cache",
              "cache_path": "/Users/nallana/Library/Caches/runmat/auto_offload/apple-apple_m2_max-metal-1.json",
              "calibrate_duration_ms": null,
              "decisions": [
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": "ElementwiseChain",
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873861
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873869
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873878
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873908
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873924
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 89.24108463333334,
                  "decision": "cpu",
                  "elements": 1,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "unary",
                  "reason": "threshold",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873926
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873926
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873934
                },
                {
                  "batch": null,
                  "cpu_estimate_ms": 446205512.4077513,
                  "decision": "gpu",
                  "elements": 5000001,
                  "flops": null,
                  "fusion_kind": null,
                  "gpu_estimate_ms": null,
                  "operation": "elementwise",
                  "reason": "residency",
                  "threshold": 4096,
                  "timestamp_ms": 1763588873936
                }
              ],
              "env_overrides_applied": false,
              "provider": {
                "backend": "metal",
                "device_id": 1,
                "name": "Apple M2 Max",
                "vendor": "Apple"
              },
              "thresholds": {
                "binary_min_elems": 4096,
                "cpu_elem_per_elem": 0.08924108463333334,
                "cpu_matmul_per_flop": 2.5e-11,
                "cpu_reduction_per_elem": 1.2e-07,
                "matmul_min_flops": 262144,
                "reduction_min_elems": 4096,
                "small_batch_max_dim": 8,
                "small_batch_min_elems": 1048576,
                "unary_min_elems": 4096
              }
            },
            "device": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            },
            "telemetry": {
              "bind_group_cache_by_layout": [
                {
                  "hits": 0,
                  "misses": 3,
                  "tag": "runmat-fusion-layout-2"
                }
              ],
              "bind_group_cache_hits": 0,
              "bind_group_cache_misses": 3,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "total_wall_time_ns": 78998458
              },
              "fused_reduction": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "fusion_cache_hits": 3,
              "fusion_cache_misses": 37,
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "matmul": {
                "count": 0,
                "total_wall_time_ns": 0
              },
              "upload_bytes": 12
            }
          },
          "points": 1000000000
        },
        {
          "impl": "python-numpy",
          "lang": "python",
          "iterations": 3,
          "median_ms": 12275.717665999764,
          "all_ms": [
            12761.654165999971,
            12194.336624999778,
            12275.717665999764
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok\n",
          "stderr_tail": "",
          "points": 1000000000
        },
        {
          "impl": "python-torch",
          "lang": "python",
          "iterations": 3,
          "median_ms": 22184.542292000515,
          "all_ms": [
            21806.82387499928,
            22256.14433300052,
            22184.542292000515
          ],
          "mse": null,
          "stdout_tail": "RESULT_ok device=mps\n",
          "stderr_tail": "",
          "device": "mps",
          "points": 1000000000
        }
      ],
      "plot": {
        "log_x": true,
        "log_x_min": 1000000
      },
      "summary": {
        "speedups": {
          "baseline": "python-numpy",
          "x_param": "points",
          "series": [
            {
              "impl": "python-torch",
              "points": [
                {
                  "param": 1000000,
                  "speedup": 0.07950349893828072
                },
                {
                  "param": 2000000,
                  "speedup": 0.08774434695433503
                },
                {
                  "param": 5000000,
                  "speedup": 0.09004179517504704
                },
                {
                  "param": 10000000,
                  "speedup": 0.12076087307985686
                },
                {
                  "param": 100000000,
                  "speedup": 0.06407249872064641
                },
                {
                  "param": 200000000,
                  "speedup": 0.12310262149902124
                },
                {
                  "param": 500000000,
                  "speedup": 0.27913850766835047
                },
                {
                  "param": 1000000000,
                  "speedup": 0.5533455459401677
                }
              ],
              "mean_speedup": 0.17471371099696317,
              "auc_trapz": 287010750.3260189
            },
            {
              "impl": "runmat",
              "points": [
                {
                  "param": 1000000,
                  "speedup": 0.31517590804848233
                },
                {
                  "param": 2000000,
                  "speedup": 0.37061111057692075
                },
                {
                  "param": 5000000,
                  "speedup": 0.5419405253865879
                },
                {
                  "param": 10000000,
                  "speedup": 0.8012942374994371
                },
                {
                  "param": 100000000,
                  "speedup": 5.11685475630361
                },
                {
                  "param": 200000000,
                  "speedup": 10.180666652365685
                },
                {
                  "param": 500000000,
                  "speedup": 23.819604068164825
                },
                {
                  "param": 1000000000,
                  "speedup": 60.21759313434248
                }
              ],
              "mean_speedup": 12.670467549086004,
              "auc_trapz": 27145602491.731476
            }
          ]
        },
        "telemetry": {
          "runs": 8,
          "per_point": [
            {
              "median_ms": 206.5752500002418,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 77.403958
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 1000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 207.71199999944656,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 83.016873
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 2000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 206.91554099994391,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 78.754335
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 5000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 208.9523750000808,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 82.899708
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 10000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 209.04262499971082,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 78.560041
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 100000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 203.28070799951092,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 81.680625
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 200000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 211.1624169992865,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 82.907001
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 500000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            },
            {
              "median_ms": 203.85600000008708,
              "upload_bytes": 12,
              "download_bytes": 0,
              "fused_elementwise": {
                "count": 10,
                "wall_ms": 78.998458
              },
              "fused_reduction": {
                "count": 0,
                "wall_ms": 0.0
              },
              "matmul": {
                "count": 0,
                "wall_ms": 0.0
              },
              "fusion_cache": {
                "hits": 3,
                "misses": 37
              },
              "bind_group_cache": {
                "hits": 0,
                "misses": 3
              },
              "kernel_launches": [
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                },
                {
                  "kernel": "fused_elementwise",
                  "precision": "f32",
                  "shape": [
                    {
                      "key": "len",
                      "value": 5000001
                    },
                    {
                      "key": "inputs",
                      "value": 2
                    },
                    {
                      "key": "rank",
                      "value": 2
                    }
                  ],
                  "tuning": [
                    {
                      "key": "wg",
                      "value": 512
                    }
                  ]
                }
              ],
              "status": "ok",
              "param": {
                "points": 1000000000
              },
              "auto_offload": {
                "decisions_total": 9,
                "by_reason": {
                  "threshold": 2,
                  "residency": 7
                },
                "by_decision": {
                  "cpu": 2,
                  "gpu": 7
                }
              }
            }
          ],
          "totals": {
            "upload_bytes": 96,
            "download_bytes": 0,
            "fused_elementwise": {
              "count": 80,
              "wall_ms": 644.2209990000001
            },
            "fused_reduction": {
              "count": 0,
              "wall_ms": 0.0
            },
            "matmul": {
              "count": 0,
              "wall_ms": 0.0
            },
            "fusion_cache": {
              "hits": 24,
              "misses": 296
            },
            "bind_group_cache": {
              "hits": 0,
              "misses": 24
            }
          },
          "device": {
            "backend": "metal",
            "device_id": 1,
            "memory_bytes": 20100448256,
            "name": "Apple M2 Max",
            "vendor": "Apple"
          },
          "auto_offload": {
            "base_source": "loaded-from-cache",
            "thresholds": {
              "binary_min_elems": 4096,
              "cpu_elem_per_elem": 0.08924108463333334,
              "cpu_matmul_per_flop": 2.5e-11,
              "cpu_reduction_per_elem": 1.2e-07,
              "matmul_min_flops": 262144,
              "reduction_min_elems": 4096,
              "small_batch_max_dim": 8,
              "small_batch_min_elems": 1048576,
              "unary_min_elems": 4096
            },
            "env_overrides_applied": false,
            "calibrate_duration_ms": null,
            "decision_counts_by_reason": {
              "threshold": 16,
              "residency": 56
            },
            "decision_counts_by_disposition": {
              "cpu": 16,
              "gpu": 56
            }
          },
          "auto_offload_calibration": {
            "runs": 8,
            "cpu_time_ms": {
              "elementwise": 1013.2759169983083,
              "reduction": 0.0,
              "matmul": 0.0
            },
            "units": {
              "elementwise": 16.0,
              "reduction": 0.0,
              "matmul_flops": 0.0
            },
            "provider": {
              "backend": "metal",
              "device_id": 1,
              "memory_bytes": 20100448256,
              "name": "Apple M2 Max",
              "vendor": "Apple"
            }
          },
          "kernel_launch_totals": {
            "fused_elementwise": 24
          }
        }
      }
    }
  ]
}