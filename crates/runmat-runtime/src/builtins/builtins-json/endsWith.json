{
  "title": "endsWith",
  "category": "strings/search",
  "keywords": [
    "endswith",
    "suffix",
    "string array",
    "ignorecase",
    "text search"
  ],
  "summary": "Check whether text inputs end with specific patterns using MATLAB-compatible broadcasting and case handling.",
  "references": [
    "https://www.mathworks.com/help/matlab/ref/endswith.html"
  ],
  "gpu_support": {
    "elementwise": false,
    "reduction": false,
    "precisions": [],
    "broadcasting": "matlab",
    "notes": "Runs on the CPU; GPU-resident inputs are gathered automatically so behaviour matches MATLAB."
  },
  "fusion": {
    "elementwise": false,
    "reduction": false,
    "max_inputs": 2,
    "constants": "inline"
  },
  "requires_feature": null,
  "tested": {
    "unit": "builtins::strings::search::endswith::tests",
    "integration": "builtins::strings::search::endswith::tests::endswith_cell_array_patterns"
  },
  "description": "`endsWith(str, pattern)` returns a logical result indicating whether each element of `str` ends with the corresponding text in `pattern`. The builtin supports string arrays, character vectors/arrays, and cell arrays of character vectors, mirroring MATLAB's implicit expansion semantics.",
  "behaviors": [
    "Accepts text inputs as string scalars/arrays, character vectors/arrays, or cell arrays of character vectors.",
    "Accepts patterns in the same formats; scalar inputs expand across the other argument following MATLAB broadcast rules.",
    "Missing string scalars (`missing`, displayed as `<missing>`) never match any pattern.",
    "Empty patterns (`\"\"` or `''`) always match non-missing text elements.",
    "Patterns that are `<missing>` never match and therefore return `false`.",
    "Character arrays treat each row as an independent element; zero-row character arrays yield empty outputs.",
    "The optional `IgnoreCase` flag can be supplied either as a trailing scalar or via the `'IgnoreCase', value` name-value pair. It accepts logical/numeric scalars and the strings `'on'`, `'off'`, `'true'`, and `'false'` (default is case-sensitive).",
    "Returns a logical scalar when the broadcasted size is one element, otherwise returns a logical array."
  ],
  "examples": [
    {
      "description": "Check if a filename ends with an extension",
      "input": "tf = endsWith(\"report.pdf\", \".pdf\");",
      "output": "tf = logical\n   1"
    },
    {
      "description": "Perform a case-insensitive suffix test",
      "input": "tf = endsWith(\"RunMat\", \"MAT\", 'IgnoreCase', true);",
      "output": "tf = logical\n   1"
    },
    {
      "description": "Apply a scalar suffix to every element of a string array",
      "input": "labels = [\"alpha\" \"beta\" \"gamma\"];\ntf = endsWith(labels, \"ma\");",
      "output": "tf = 1\u00d73 logical array\n   0   0   1"
    },
    {
      "description": "Use element-wise suffixes with implicit expansion",
      "input": "names = [\"hydrogen\"; \"helium\"; \"lithium\"];\nsuffixes = [\"gen\"; \"ium\"; \"ium\"];\ntf = endsWith(names, suffixes);",
      "output": "tf = 3\u00d71 logical array\n   1\n   1\n   1"
    },
    {
      "description": "Test suffixes for a cell array of character vectors",
      "input": "C = {'Mercury', 'Venus', 'Mars'};\ntf = endsWith(C, 's');",
      "output": "tf = 1\u00d73 logical array\n   0   1   1"
    },
    {
      "description": "Provide multiple suffixes as a column vector",
      "input": "tf = endsWith(\"saturn\", ['n'; 'x'; 'r']);",
      "output": "tf = 3\u00d71 logical array\n   1\n   0\n   0"
    },
    {
      "description": "Handle empty patterns and missing values",
      "input": "texts = [\"\", missing];\ntf = endsWith(texts, \"\");",
      "output": "tf = 1\u00d72 logical array\n   1   0"
    }
  ],
  "faqs": [
    {
      "question": "What types can I pass to `endsWith`?",
      "answer": "Use string scalars/arrays, character vectors/arrays, or cell arrays of character vectors for both arguments. Mixed combinations are accepted, and RunMat performs MATLAB-style implicit expansion when the array sizes differ."
    },
    {
      "question": "How do I ignore letter case?",
      "answer": "Supply `'IgnoreCase', true` (or `'on'`) after the pattern argument. The option is case-insensitive, so `'ignorecase'` also works. The default is `false`, matching MATLAB."
    },
    {
      "question": "What happens with empty patterns?",
      "answer": "Empty patterns (`\"\"` or `''`) always match non-missing text elements. When the text element is missing (`<missing>`), the result is `false`."
    },
    {
      "question": "Can I provide multiple suffixes at once?",
      "answer": "Yes. Provide `pattern` as a string array, character array, or cell array of character vectors. RunMat applies implicit expansion so that scalar inputs expand across the other argument automatically."
    },
    {
      "question": "How are missing strings treated?",
      "answer": "Missing string scalars (displayed as `<missing>`) never match any pattern and produce `false` in the result. Use `ismissing` if you need to handle missing values separately."
    },
    {
      "question": "Does `endsWith` run on the GPU?",
      "answer": "No. The builtin executes on the CPU. If inputs reside on the GPU (for example, after other accelerated operations), RunMat gathers them automatically so behaviour matches MATLAB."
    },
    {
      "question": "Does `endsWith` preserve the input shape?",
      "answer": "Yes. The output is a logical array whose shape reflects the MATLAB-style implicit expansion result. When that shape contains exactly one element, the builtin returns a logical scalar."
    }
  ],
  "links": [
    {
      "label": "`contains`",
      "url": "./contains"
    },
    {
      "label": "`startsWith`",
      "url": "./startswith"
    },
    {
      "label": "`regexp`",
      "url": "./regexp"
    },
    {
      "label": "`regexpi`",
      "url": "./regexpi"
    }
  ],
  "source": {
    "label": "`crates/runmat-runtime/src/builtins/strings/search/endswith.rs`",
    "url": "https://github.com/runmat-org/runmat/blob/main/crates/runmat-runtime/src/builtins/strings/search/endswith.rs"
  },
  "gpu_residency": "You usually do NOT need to call `gpuArray` yourself in RunMat (unlike MATLAB).\n\n`endsWith` always executes on the host, but RunMat's runtime automatically gathers any GPU-resident inputs before evaluating the suffix check. Because the builtin registers a `ResidencyPolicy::GatherImmediately`, the planner gathers device handles eagerly and computes the logical result on the CPU. You may still call `gpuArray` manually for compatibility with MATLAB code; the runtime gathers the inputs just in time, so results match MATLAB precisely.",
  "gpu_behavior": [
    "`endsWith` performs host-side suffix comparison. When inputs currently live on the GPU, RunMat gathers them back to the host before evaluation so the behaviour is identical to MATLAB. No acceleration provider hooks are required for this builtin."
  ]
}
